<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>

    <title>Student Accountabilities</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f2f2f2;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        h3 {
            font-size: 24px;
            margin: 20px 0;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .btn {
            padding: 10px 20px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }

        .btn:hover {
            background-color: #0056b3;
        }

        .pagination {
            text-align: center;
            margin-top: 20px;
        }
        .pagination {
        text-align: center;
        margin-top: 20px;
    }

    /* Style the pagination buttons */
    .pagination button {
        padding: 5px 10px;
        background-color: #007BFF;
        color: #fff;
        border: none;
        cursor: pointer;
        border-radius: 5px;
        margin: 0 5px;
    }

    .pagination button.active {
        background-color: #0056b3;
    }
    </style>
</head>
<body>
    <div class="container student-buttons d-flex justify-content-end" id="containers">
        <div class="btn-group" role="group">
            <button class="btn me-2" id="add-student-list-button" onclick="printTableData()">
                <i class="fas fa-print"></i> Print Recorded Attendance
            </button>
            <button class="btn me-2" id="add-student-button" onclick="  downloadTableData()">
                <i class="fas fa-download"></i> Download Recorded Attendance
            </button>
            <button class="btn me-2" id="add-student-button">
            <i class="bi bi-file-earmark-plus"></i> Add student list
            </button>
        </div>
    </div>
    <span class="table-title"><h3> <i class="fas fa-list"></i>  Student Accountabilities</h3></span>
    <div class="scroll-pane">
        <table id="accountabilities-table">
            <thead>
                <tr>
                    <th class="sortable-header">Student ID</th>
                    <th class="sortable-header">Student Name</th>
                    <th class="sortable-header">Membership Fee</th>
                    <th class="sortable-header">Membership Status</th>
                    <th class="sortable-header">Fines</th>
                    <th class="sortable-header">Fines Status</th>
                    <th class="sortable-header">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>2023-05-01</td>
                    <td>John Smith</td>
                    <td>$100</td>
                    <td>Unpaid</td>
                    <td>$10</td>
                    <td>Unpaid</td>
                    <td>
                        <button class="edit-button ellipsis-button"> <i class="bi bi-pencil-square"></i></button>
                        <button class="delete-button ellipsis-button"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
                <tr>
                    <td>2023-05-01</td>
                    <td>John Smith</td>
                    <td>$100</td>
                    <td>Unpaid</td>
                    <td>$10</td>
                    <td>Unpaid</td>
                    <td>
                        <button class="edit-button ellipsis-button"> <i class="bi bi-pencil-square"></i></button>
                        <button class="delete-button ellipsis-button"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
                <tr>
                    <td>2023-05-01</td>
                    <td>John Smith</td>
                    <td>$100</td>
                    <td>Unpaid</td>
                    <td>$10</td>
                    <td>Unpaid</td>
                    <td>
                        <button class="edit-button ellipsis-button"> <i class="bi bi-pencil-square"></i></button>
                        <button class="delete-button ellipsis-button"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
                <tr>
                    <td>2023-05-01</td>
                    <td>John Smith</td>
                    <td>$100</td>
                    <td>Unpaid</td>
                    <td>$10</td>
                    <td>Unpaid</td>
                    <td>
                        <button class="edit-button ellipsis-button"> <i class="bi bi-pencil-square"></i></button>
                        <button class="delete-button ellipsis-button"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
                <tr>
                    <td>2023-05-01</td>
                    <td>John Smith</td>
                    <td>$100</td>
                    <td>Unpaid</td>
                    <td>$10</td>
                    <td>Unpaid</td>
                    <td>
                        <button class="edit-button ellipsis-button"> <i class="bi bi-pencil-square"></i></button>
                        <button class="delete-button ellipsis-button"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
                <tr>
                    <td>2023-05-01</td>
                    <td>John Smith</td>
                    <td>$100</td>
                    <td>Unpaid</td>
                    <td>$10</td>
                    <td>Unpaid</td>
                    <td>
                        <button class="edit-button ellipsis-button"> <i class="bi bi-pencil-square"></i></button>
                        <button class="delete-button ellipsis-button"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
                <tr>
                    <td>2023-05-01</td>
                    <td>John Smith</td>
                    <td>$100</td>
                    <td>Unpaid</td>
                    <td>$10</td>
                    <td>Unpaid</td>
                    <td>
                        <button class="edit-button ellipsis-button"> <i class="bi bi-pencil-square"></i></button>
                        <button class="delete-button ellipsis-button"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
                <tr>
                    <td>2023-05-01</td>
                    <td>John Smith</td>
                    <td>$100</td>
                    <td>Unpaid</td>
                    <td>$10</td>
                    <td>Unpaid</td>
                    <td>
                        <button class="edit-button ellipsis-button"> <i class="bi bi-pencil-square"></i></button>
                        <button class="delete-button ellipsis-button"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
                <tr>
                    <td>2023-05-01</td>
                    <td>John Smith</td>
                    <td>$100</td>
                    <td>Unpaid</td>
                    <td>$10</td>
                    <td>Unpaid</td>
                    <td>
                        <button class="edit-button ellipsis-button"> <i class="bi bi-pencil-square"></i></button>
                        <button class="delete-button ellipsis-button"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
                <tr>
                    <td>2023-05-01</td>
                    <td>will smith</td>
                    <td>$100</td>
                    <td>Unpaid</td>
                    <td>$10</td>
                    <td>Unpaid</td>
                    <td>
                        <button class="edit-button ellipsis-button"> <i class="bi bi-pencil-square"></i></button>
                        <button class="delete-button ellipsis-button"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>

            </tbody>
        </table>
    </div>
    <div class="pagination">
        <button id="first-page-button" onclick="goToPage(1)" disabled>&lt;&lt;</button>
        <button id="previous-page-button" onclick="previousPage()" disabled>&lt; Previous</button>
        <span id="pagination-numbers"></span>
        <button id="next-page-button" onclick="nextPage()">Next &gt;</button>
        <button id="last-page-button" onclick="goToPage(pageCount)">&gt;&gt;</button>
    </div>
</div>
<script>
    const table = document.getElementById('accountabilities-table');
    const rows = table.querySelectorAll('tbody tr');
    const rowsPerPage = 5; // Adjust this to the desired number of rows per page
    let currentPage = 1;
    const pageCount = Math.ceil(rows.length / rowsPerPage);

    function updateTable() {
        const startIndex = (currentPage - 1) * rowsPerPage;
        const endIndex = startIndex + rowsPerPage;

        rows.forEach((row, index) => {
            if (index >= startIndex && index < endIndex) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });

        // Display all page numbers
        let paginationNumbers = '';
        for (let i = 1; i <= pageCount; i++) {
            paginationNumbers += `<button onclick="goToPage(${i})" ${i === currentPage ? 'class="active"' : ''}>${i}</button>`;
        }
        document.getElementById('pagination-numbers').innerHTML = paginationNumbers;

        document.getElementById('first-page-button').disabled = currentPage === 1;
        document.getElementById('previous-page-button').disabled = currentPage === 1;
        document.getElementById('next-page-button').disabled = currentPage === pageCount;
        document.getElementById('last-page-button').disabled = currentPage === pageCount;
    }

    function goToPage(page) {
        currentPage = page;
        updateTable();
    }

    function previousPage() {
        if (currentPage > 1) {
            currentPage--;
            updateTable();
        }
    }

    function nextPage() {
        if (currentPage < pageCount) {
            currentPage++;
            updateTable();
        }
    }

    // Initialize the table and pagination
    updateTable();
</script>
<script>
         function printTableData() {
        const table = document.getElementById('accountabilities-table');
        const rows = table.querySelectorAll('tbody tr');

        let tableData = '<table style="border-collapse: collapse;">'; // Add a style to remove the border

        // Add table headers excluding the last column (Actions)
        tableData += '<thead>';
        tableData += '<tr>';
        table.querySelectorAll('thead th').forEach(header => {
            if (header.textContent !== 'Actions') {
                tableData += '<th>' + header.textContent + '</th>';
            }
        });
        tableData += '</tr>';
        tableData += '</thead>';

        // Add table body, excluding the last column (Actions)
        tableData += '<tbody>';
        rows.forEach(row => {
            tableData += '<tr>';
            row.querySelectorAll('td').forEach((cell, index) => {
                if (index !== 6) { // Skip the last column (Actions)
                    tableData += '<td>' + cell.textContent + '</td>';
                }
            });
            tableData += '</tr>';
        });
        tableData += '</tbody>';
        tableData += '</table>';

        // Open a new window and print the table data
        const printWindow = window.open('', '', 'width=600,height=600');
        printWindow.document.open();
        printWindow.document.write('<html><head><title>Printed Table</title></head><body>');
        printWindow.document.write('<h3>Student Accountabilities</h3>');
        printWindow.document.write(tableData);
        printWindow.document.write('</body></html>');
        printWindow.document.close();
        printWindow.print();
        printWindow.close();
    }

    function downloadTableData() {
        const table = document.getElementById('accountabilities-table');
        const clonedTable = table.cloneNode(true);

        // Remove the "Actions" column from the cloned table
        clonedTable.querySelectorAll('tr').forEach(row => {
            const cells = row.querySelectorAll('td, th');
            if (cells.length > 0) {
                cells[cells.length - 1].remove();
            }
        });

        // Create a new XLSX workbook and add the cloned table to it
        const ws = XLSX.utils.table_to_sheet(clonedTable);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'TableData');

        // Save the workbook as an XLSX file and trigger the download
        XLSX.writeFile(wb, 'table_data.xlsx');
    }
</script>

</body>
</html>
